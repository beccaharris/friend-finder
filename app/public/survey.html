<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Friend Finder | Survey</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
  <link rel="stylesheet" href="./assets/css/style.css">
  <link href="https://fonts.googleapis.com/css?family=Gothic+A1" rel="stylesheet">
  <link rel="icon" href="./assets/images/user-circle.png">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
</head>

<body>

  <div class="container">
    <div class="card">
      <h1 class="survey-title">Survey Questions</h1>
      <span class="required">
        <strong>
          <em>* All fields are required</em>
        </strong>
      </span>
      

      <!-- ========== Begin Survey ========== -->
      <!-- ================================== -->
      <h3>About You</h3>
      <h5>Name</h5>
      <input type="text" id="name" class="form-control" required>
      <h5>Link to Photo Image</h5>
      <input type="text" id="photo" class="form-control" required>
      <hr>

      <h3>Question 1</h3>
      <h5>You like animals.</h5>
      <select class="chosen-select" id="question-1">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 2</h3>
      <h5>On any given day, you would rather be indoors than outdoors.</h5>
      <select class="chosen-select" id="question-2">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 3</h3>
      <h5>You like to meet new people.</h5>
      <select class="chosen-select" id="question-3">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 4</h3>
      <h5>Playing a game is fun only when you win.</h5>
      <select class="chosen-select" id="question-4">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 5</h3>
      <h5>Decisions that people make quickly are always wrong.</h5>
      <select class="chosen-select" id="question-5">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 6</h3>
      <h5>It is often difficult for you to relate to other people’s feelings.</h5>
      <select class="chosen-select" id="question-6">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 7</h3>
      <h5>In a discussion, truth should be more important than people’s sensitivities.</h5>
      <select class="chosen-select" id="question-7">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 8</h3>
      <h5>You rarely get carried away by fantasies and ideas.</h5>
      <select class="chosen-select" id="question-8">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 9</h3>
      <h5>You consider yourself mischevious.</h5>
      <select class="chosen-select" id="question-9">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 10</h3>
      <h5>You feel more energetic after spending time with a group of people.</h5>
      <select class="chosen-select" id="question-10">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>
      <br>
      <br>

      <!-- ========= Submit Survey ========== -->
      <!-- ================================== -->
      <button type="submit" class="btn btn-info btn-lg btn-block" id="submit">
        <i class="fa fa-check-circle" aria-hidden="true"></i>
        Submit
      </button>
      <hr>
    </div>
    <!-- ============= Footer & Copyright ============== -->
    <!-- ================================== -->
    <footer class="footer fixed-bottom">
        <a href="/"><i class="fa fa-4x fa-home"></i></a>
        <p><a href="/api/friends" target="_blank">API Friends List</a> | <a href="https://github.com/beccaharris/friend-finder" target="_blank">GitHub Repo</a><br>&copy; 2018 Becca Harris</p>
    </footer>
  </div>

  <!-- Modal (open on "Submit" click) -->
  <!-- ============================== -->
  <div id="friend-result-modal" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Your best match is...</h2>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h3 id="new-friend-name"></h3>
          <img id="new-friend-picture" src="" alt="New friend picture" style="max-width: 350px;">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript">

    // ========== Chosen Dropdown CSS ========== //
    // ========================================= //
    var config = {
      ".chosen-select": {},
      ".chosen-select-deselect": {
        allow_single_deselect: true
      },
      ".chosen-select-no-single": {
        disable_search_threshold: 10
      },
      ".chosen-select-no-results": {
        no_results_text: "No results found"
      },
      ".chosen-select-width": {
        width: "95%"
      }
    };

    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }

    // ===== jQuery for click of submit button ===== //
    // ============================================= //

    $('#submit').on('click', function (event) {
      event.preventDefault
      // == Form validation == //
      function validate() {
        var isValid = true;
        $(".form-control").each(function () {
          if ($(this).val() === "") {
            isValid = false;
          }
        });

        $(".chosen-select").each(function () {

          if ($(this).val() === "") {
            isValid = false;
          }
        });
        return isValid;
      }
      if (validate()) {
        // == Create newFriend object == //
        var newFriend = {
          name: $('#name').val().trim(),
          picture: $('#photo').val().trim(),
          scores: [
            $('#question-1').val(),
            $('#question-2').val(),
            $('#question-3').val(),
            $('#question-4').val(),
            $('#question-5').val(),
            $('#question-6').val(),
            $('#question-7').val(),
            $('#question-8').val(),
            $('#question-9').val(),
            $('#question-10').val()
          ]
        };
        // == Post newFriend object == //
        $.post('/api/friends', newFriend, function (data) {

          $("#new-friend-name").text(data.name);
          $("#new-friend-picture").attr("src", data.picture);

          $('#friend-result-modal').modal('toggle')

        });
      } else {
        alert("'Name' and 'Link to Photo Image' fields are required. Make sure these are filled out before submitting!");
      }
    });

  </script>

</body>

</html>